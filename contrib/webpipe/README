WebPipe
=======

`webpipe` is a companion web front-end for [newspipe][2] that allows you to keep track of read news items, flag items for follow-up and generate a "metafeed" of all your news that you can view on a PDA or on any web browser.

It was designed to run on pretty much any web server running a stock install of PHP (requiring nothing more than the IMAP extension), under any sort of user account, and in close relationship to [newspipe][2] (it takes a few shortcuts to parse and display [newspipe][2]'s specific MIME format).

You can use it to access your [newspipe][2] inbox and read, flag and delete messages (i.e., move them to Trash), but it's _not_ a generic webmail client (it will probably choke on anything that's not generated by [newspipe][2]), and will never attempt to be one.

* * *

Requirements
------------

You need:

* PHP (4.3.4 or above, see [Entropy][1] if you want to run this on a Mac) with IMAP support compiled in.
* A working installation of [newspipe][2]. You do want something to read, right?
* Quick access to your IMAP server (remember that `webpipe` will be fetching messages on the fly).

Configuration
-------------

* Place all the PHP files where your Web server can process them.
* Open `config.php.sample` and edit it to your liking, saving it as `config.php`.
  * Since the IMAP password has to be stored in clear text, it is STRONGLY RECOMMENDED to put `config.php` outside the web root and change `main.php` accordingly (that's why it's separate from `main.php`).
  * You can change the folder webpipe reads from by modifying the `MAILBOX` variable. See the [imap_open][5] documentation for details.
  * As a fail-safe, `webpipe` does NOT delete messages. It does, however, move them to the `Trash` folder or to another folder of your own choosing. Check if that folder exists and matches what is defined in `config.php`.
* Make sure your web server supports `PATH_INFO`. [Apache][6] is pretty straightforward to configure for this - you can enable it via an `.htaccess` file like so:

    <Files "*.php">
      AcceptPathInfo On
    </Files>

* Finally, if you don't use the built-in authentication (which is still under testing) protect your `webpipe` install with an username and password. Again, check the [Apache][7] documentation for this.

* * *

Changelog
---------

2004-10-23:

* Added User Agent Profile handling (phone screen size detection for the non-WAP-savvy) and image rescaling/rotation (since some phones don't scroll horizontally, I rotate the image 90 degrees, fit it to screen width, and you can scroll it vertically).
* Added built-in HTTP authentication (very simple and probably buggy, since I'm trying to get it to work with pretty dumb devices).
* Added different privilege levels, so that you can access newspipe without any form of authentication from your local subnet, let your friends read RSS feeds but not delete or edit items, etc.


* * *

ToDo
----

* Extensive authentication tests. You have been warned - this is mostly being tested against _phones_, which tend to have amazingly stupid HTTP bugs and very poor error handling. The current HTTP auth implementation isn't something I consider bulletproof, but the rest of the code should be pretty secure.
* Pure WAP version (probably never going to happen, but you're free to make the necessary changes and send them to me for inclusion).
* Character encoding fixes. Although [Bruno David][3] has made [newspipe][2] as UTF-8 clean as can be, there are always oddities with some devices, and I've spotted a couple already.
* IMAP performance improvements. I've heard good things of some "pure PHP" IMAP libraries, but I wanted to keep the code simple enough for other people to tinker with, so I used the (admittedly not very efficient) native PHP bindings.
* Image caching, HTTP optimizations, etc. I have oodles of code to do this for "real" browsers, but since the code is designed to be used with _phones_ (which can't really take advantage of any of that) and by a handful of users at best, this won't be added anytime soon.


* * *
  
FAQ
---

* What's the point of accessing your IMAP store to read RSS feeds? Isn't straight e-mail/MMS enough with [newspipe][2]?

Actually, no. Let's say you're out with your PDA and want to keep up with the news, but only have Web access. Using `webpipe`, you can quickly check your latest newspipe items, flag messages for follow-up and delete the ones you're not interested in. 

* `webpipe` won't display regular mail!

Of course not. `webpipe` is a very simple IMAP-to-web shim that only understands [newspipe][2]'s simple MIME structure.

* Is there a WAP version?

Not yet. The templates and code were kept simple enough so that a WAP version can be put together with minimal fuss (provided someone codes the required encoding and content paging logic). The original version of `webpipe` used XSLT transforms with an intent to accomplish that, but I couldn't be bothered to maintain it when more and more phones are using XHTML and WAP 2.0.

* Can I use it with a POP account?

Most likely not. PHP's [imap_open][5] supports POP3, but some of the operations (deleting, flagging, etc.) won't work properly at all.

* Why `PATH_INFO`?

Well, because the URLs are simpler and mostly because my Blackberry would choke on multi-parameter GETs for some reason. This way it doesn't have to understand what it's doing, the URLs look much cleaner, and they're cache-friendly.

* What Phones/PDAs has `webpipe` been tested with?

Every single one that crossed my desk, basically:

  * SonyEricsson V800, Z1010, K700i, S700 (XHTML mode, no WAP gateway)
  * Samsung Z105 (only once, couldn't test images)
  * Nokia 6630 (not recommended due to a flaky browser)
  * RIM Blackberry 7100v (With BES 3.6)
  * RIM Blackberry 7230 (With BES 3.6)
  * RIM Blackberry 7290 (With BES 3.6)
  * Pocket PC (works with any version, although there are occasional issues with UTF-8)
  * Palm Tungsten T3 (previous version worked with WebPro, should work fine with Blazer)

* * *

Contact
-------

Please bear in mind that THIS IS NOT PART OF NEWSPIPE. It is only a humble contribution. As such, please direct any gripes, bug reports, etc. directly to [me][4] (you'll find the e-mail address on that page).

Acknowledgements
----------------

`webpipe` wouldn't have sprung into life without Ricardo M. Reyes' [newspipe][2]. [Bruno David][3] changed [newspipe][2]'s MIME structure to what it is today. Lots of anonymous taxi drivers put up with me rotating the phone and holding it up high to read comic strips.

[1]: http://www.entropy.ch/software/macosx/php/
[2]: http://newspipe.sf.net
[3]: http://www.litux.org
[4]: http://the.taoofmac.com/space/RuiCarmo
[5]: http://www.php.net/manual/en/function.imap-open.php
[6]: http://httpd.apache.org/docs-2.0/mod/core.html#acceptpathinfo
[7]: http://httpd.apache.org/docs-2.0/mod/core.html#require
